WITH processed_data AS (
    SELECT 
        "Custom_Tags", 
        "Computer_Name", 
        CAST("CPU_Consumption" AS NUMERIC) AS "Total_CPU_Usage", 
        CAST("Number_of_Processor_Cores" AS NUMERIC) AS "Cores",
        100 AS "Total_CPU_Available",
        ROUND(("CPU_Consumption"::NUMERIC / "Total_CPU_Available") * 100) AS "CPU_Percentage",
        (regexp_matches("High_CPU_Processes_5_", '\S+', 'g'))[1] AS "Process"  -- Applying regex
    FROM your_table_name -- Replace with your actual table name
)
SELECT 
    "Custom_Tags", 
    "Computer_Name", 
    "CPU_Consumption", 
    "Number_of_Processor_Cores", 
    "Total_CPU_Usage", 
    "Total_CPU_Available", 
    "CPU_Percentage", 
    "Process"
FROM 
    processed_data
WHERE 
    "CPU_Percentage" >= 90
ORDER BY 
    "Custom_Tags", 
    "Computer_Name";
