WITH combined AS (
    -- "First search"
    SELECT
        check_id          AS cve_id,
        computer_name,
        remediation_date,
        created_date,
        is_cisa_kev,
        custom_tags,
        "CVSS_v3 Base_score" AS v3_score,     -- rename
        "CVSS_v3_Severity"   AS v3_severity,  -- rename
        "CVSS_score"         AS v2_score,     -- rename
        severity             AS v2_severity
    FROM your_table_name
    WHERE index_name LIKE 'fs_%'
      AND sourcetype = 'tanium'
      AND question = 'FS-Remediated-CVES-90-Days'
    
    UNION
    
    -- "Second search"
    SELECT
        check_id          AS cve_id,
        computer_name,
        remediation_date,
        created_date,
        is_cisa_kev,
        custom_tags,
        "CVSS_v3 Base_score" AS v3_score,
        "CVSS_v3_Severity"   AS v3_severity,
        "CVSS_score"         AS v2_score,
        severity             AS v2_severity
    FROM your_table_name
    WHERE index_name LIKE 'fs_%'
      AND sourcetype = 'tanium'
      AND question = 'Tanium-Reporting-(Source-Data)'
      AND is_cisa_kev IS NOT NULL
      AND "CVSS_v3_Severity" IS NOT NULL
      AND severity IS NOT NULL
)

SELECT 
    v3_severity, 
    COUNT(*) AS total_count
FROM (
    -- Deduplicate by (computer_name, cve_id), filtering out rows 
    -- that have a *non*-NULL Remediation_Date
    SELECT DISTINCT ON (computer_name, cve_id) *
    FROM combined
    WHERE remediation_date IS NULL
) AS deduped
GROUP BY
    v3_severity
ORDER BY
    v3_severity;