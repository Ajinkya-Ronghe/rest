convertToPDF(data: any[]): Blob {
  const pdf = new jsPDF();
  const pageWidth = pdf.internal.pageSize.getWidth();
  const margin = 10;
  const cellPadding = 2;
  const cellHeight = 10;

  // Extract column headers (keys from the first object)
  const headers = Object.keys(data[0]);

  // Add title
  pdf.text('Exported Data', margin, margin);

  // Calculate column width (divide equally for simplicity)
  const columnWidth = (pageWidth - 2 * margin) / headers.length;

  // Draw header row
  let currentY = margin + 10; // Start below the title
  headers.forEach((header, index) => {
    const xPos = margin + index * columnWidth;
    pdf.rect(xPos, currentY, columnWidth, cellHeight); // Draw cell
    pdf.text(header, xPos + cellPadding, currentY + cellHeight / 2 + 2); // Add header text
  });

  // Draw rows
  currentY += cellHeight; // Move to the next row
  data.forEach((row) => {
    headers.forEach((header, index) => {
      const xPos = margin + index * columnWidth;
      pdf.rect(xPos, currentY, columnWidth, cellHeight); // Draw cell
      const cellText = row[header] !== undefined ? String(row[header]) : '';
      pdf.text(cellText, xPos + cellPadding, currentY + cellHeight / 2 + 2); // Add cell text
    });
    currentY += cellHeight; // Move to the next row
  });

  // Return the PDF as a Blob
  return pdf.output('blob');
}
