import * as html2pdf from 'html2pdf.js';

convertToPDF(): Promise<Blob> {
  const element = document.getElementById('pdfTable'); // The HTML element ID for the table

  if (!element) {
    console.error('Element with ID "pdfTable" not found');
    return Promise.reject('HTML element not found');
  }

  const options = {
    margin: 10,
    html2canvas: { scale: 2 }, // High resolution
    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
  };

  // Return a Promise that resolves to a Blob
  return new Promise((resolve, reject) => {
    html2pdf()
      .from(element)
      .set(options)
      .outputPdf('blob') // Generate as Blob
      .then((blob: Blob) => resolve(blob))
      .catch((error: any) => reject(error));
  });
}
