public List<StagingData> fetchAndUpdateTop100Unprocessed() {
    String query = "UPDATE StagingData " +
                   "SET status = 'P' " +
                   "WHERE id IN (SELECT id FROM StagingData WHERE status = 'U' ORDER BY id ASC LIMIT 100) " +
                   "RETURNING *";

    // Perform the update and fetch the updated rows
    return jdbcTemplate.query(query, new StagingDataRowMapper());
}